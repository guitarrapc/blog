---
Title: aquaでPowerShell(pwsh)をインストールする
Category:
- PowerShell
- Ubuntu
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/6802418398319595479
PreviewURL: https://tech.guitarrapc.com/draft/entry/5Dy_ntOGcm17WHenDxGFQ0FbOkE
CustomPath: 2025/01/12/235900
---

PowerShell 7以降をaquaでインストールする方法を紹介します。

[:contents]

## 必要条件

PowerShellがaquaレジストリに追加されたのは先日なので、4.292.0以上のバージョンが必要です。

* [aqua-registry](https://github.com/aquaproj/aqua-registry/releases/tag/v4.292.0) v4.292.0以上

```yaml
registries:
  - type: standard
    ref: v4.295.1 # renovate: depName=aquaproj/aqua-registry
```

## PowerShellをインストール

aqua.yamlにPowerShellを追加します。`aqua g`でパッケージ名を検索してもいいですし、パッケージを指定できます。

```sh
# パッケージ名を検索、aqua.yamlには追加しない
$ aqua g
# PowerShellパッケージを指定、aqua.yamlに追加
$ aqua g -i PowerShell/PowerShell
# PowerShellパッケージを指定、aqua.yamlに追加。バージョンは指定する
$ aqua g -i -s PowerShell/PowerShell
```

`--select-version`あるいは`-s`は指定したパッケージのバージョンを指定できるパラメーターで、指定しない場合は最新バージョンがインストールされます。
指定するとデフォルトで30バージョンを選べるのですが、こうやって見るとPowerShellのリリースページは早いですね。

![image](https://github.com/user-attachments/assets/a47d7b8f-5b8b-4be5-91b7-d321ff38019b)

どうでもいいですが、リリース一覧の取得はGitHub APIから取得したまま表示しています。[^1] なので、バージョン順ではなく、リリース日付順になっています。このあたりのバージョン順序はライブラリの思想出ますね。

![image](https://github.com/user-attachments/assets/e62b68d5-363c-4d07-8f01-915c34d85426)

## まとめ

aquaでのPowerShellインストールはaptと違ってパスごとのバージョン管理できるのが便利です。シェルなので単一でもいいというのはありますが、いろいろなバージョンを試すにはきわめて有用です。

あと、apt経由のインストールはパッケージリポジトリを導入する必要があり面倒なんですよね。Ubuntuに限らず、ディストリビューションのスタンダードに配信していないのでインストール面倒なのはちょっと困ったものです。

> [Installing PowerShell on Ubuntu - Microsoft Learn](https://learn.microsoft.com/en-us/powershell/scripting/install/install-ubuntu?view=powershell-7.4)
>
> [Install PowerShell on Linux - Microsoft Learn](https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-linux?view=powershell-7.4)


[^1]: aquaの[ListReleases](https://github.com/aquaproj/aqua/blob/f28fbe2bd7af9b2a7b4897bea620184a22e1cbdd/pkg/versiongetter/github_release.go#L29C2-L29C14)で取得するのですが、実装は[go-githubを使う宣言](https://github.com/aquaproj/aqua/blob/f28fbe2bd7af9b2a7b4897bea620184a22e1cbdd/pkg/github/github.go#L10)をしています。肝心のgo-GitHubは[ListReleases](https://github.com/google/go-github/blob/1343645a00933bc5c9545fc676decb69d9418b6a/github/repos_releases.go#L93-L111)メソッドで、GitHub APIのhttpエンドポイント[List releases](https://docs.github.com/en/rest/releases/releases#list-releases)を使っています。
