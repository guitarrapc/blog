---
Title: Riderのブレークポイントログと同様の機能をVisual Studioのトレースポイントで行う
Category:
- C#
- Unity
Date: 2026-01-04T23:00:00+09:00
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/17179246901341144143
PreviewURL: https://tech.guitarrapc.com/draft/entry/voYNZz0lBG-dQ0rMixC7q0NbdnE
CustomPath: 2026/01/04/230000
---

Riderのブレークポイントログについての[記事](https://note.com/ohbashunsuke/n/n9ff12e7a1793)を読んだのですが、Visual Studioにも同様の機能があります。Visual Studioでも同じことができないか、と悩んでいる人に向けての紹介です。

Unityで開発していると「ちょっとここの値を確認したいな」と思って、ログ追加のためにDebug.Logを書く → コンパイルが走る → 数十秒待つ → その間に思考が途切れる、という経験はありませんか？
Visual Studioのトレースポイントを使えば、Riderのブレークポイントログと同様に、コードを書き換えずに値を確認できます。ブレークポイントを置いたらログを設定するだけで簡単なので、ぜひお試しください。

[:contents]

## Visual Studioのトレースポイント

[Microsoft Learn](https://learn.microsoft.com/ja-jp/visualstudio/debugger/using-tracepoints?view=visualstudio)に、Visual Studioのトレースポイントについて説明があります。
本記事はVisual Studio 2026[^1]で、C#を用いて紹介します。本機能は、マネージド言語(C#、Visual Basic、F#)とネイティブコード、およびJavaScriptやPythonなどの言語でサポートされています。

## サンプルプログラム

ASP.NET Core Web APIのデフォルトプロジェクトをサンプルとして用いて「リクエストの時にデバッグしたい」という実ケースあるあるを想定しましょう。
プログラムは、`http://localhost:5000/weatherforecast`にアクセスすると、5日分の天気予報を返すものです。

```cs
var builder = WebApplication.CreateBuilder(args);

var app = builder.Build();

// Configure the HTTP request pipeline.
var summaries = new[]
{
    "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching"
};

app.MapGet("/weatherforecast", () =>
{
    var forecast = Enumerable.Range(1, 5).Select(index =>
        new WeatherForecast
        (
            DateOnly.FromDateTime(DateTime.Now.AddDays(index)),
            Random.Shared.Next(-20, 55),
            summaries[Random.Shared.Next(summaries.Length)]
        ))
        .ToArray();
    return forecast;
})
.WithName("GetWeatherForecast");

app.Run();

internal record WeatherForecast(DateOnly Date, int TemperatureC, string? Summary)
{
    public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
}
```

## Visual Studioで「コンパイルしないログ」を出す

やることはシンプルです。Riderの場合と同様に次の手順です。

- ブレークポイントを置く
- そのブレークポイントにログ出力を設定
- デバッガを起動する

C#を書いているとブレークポイントは普段から使いますよね。トレースポイントは、このブレークポイントにログを設定するだけです。
コードを書き換えず、Debug.Logも書かず、コンパイルも走りません。

やってみましょう。

まずは、ブレークポイントを置きます。

[f:id:guitarrapc_tech:20260106175932p:plain:alt=ログを出したい行にブレークポイントを置く]<!--image-1.png-->

ブレークポイントの赤い丸にマウスホバーして、**Settings (日本語なら設定)**をクリックします。

[f:id:guitarrapc_tech:20260106175938p:plain:alt=赤い丸にマウスを合わせてSettingsをクリック]<!--image.png-->

いくつかチェックボックスがあります。**Actions (アクション)**チェックボックスをオンにします。

[f:id:guitarrapc_tech:20260106175945p:plain:alt=Actionsチェックボックスをオンにする]<!--image-2.png-->

**Continue code execution (コードの実行を続行)**はオンのままにします。

[f:id:guitarrapc_tech:20260106175951p:plain:alt=Actionsチェックボックスをオンにすると出力ウィンドウへのメッセージを入力できる]<!--image-3.png-->

**Show a message on the Output Window: 出力メッセージ**にログ出力したい内容を記述します。

[f:id:guitarrapc_tech:20260106175958p:plain:alt=出力メッセージを付ける]<!--image-4.png-->

文字列だけでなく、調べたい変数も`{}`で囲むと展開されます。例えば、`forecast`変数を見たいなら`{forecast}`と書きます。
インテリセンスも効くので、割と自由に指定できます。

[f:id:guitarrapc_tech:20260106180004p:plain:alt=変数も指定できる]<!--image-5.png-->

その後、F5キーでデバッガを起動します。
これで、出力ウィンドウ (Output Window)にログが出力されます。

ブラウザやcurlで`http://localhost:5000/weatherforecast`にアクセスしてみましょう。

## Unityでトレースポイントを出す

UnityでVisual Studioを使っているときのトレースポイントの例を示します。

雑なスクリプトを用意します。

```cs
using System.Collections;
using System.Collections.Generic;
using Unity.VisualScripting;
using UnityEngine;

public class Sample : MonoBehaviour
{
    // Start is called before the first frame update
    void Start()
    {
        int counter = 0;
        for (int i = 0; i <= 10; i++)
        {
            counter += 1;
        }
    }
}
```

先ほどの例同様にブレークポイントを設定、ログメッセージを設定します。

[f:id:guitarrapc_tech:20260106180011p:plain:alt=Unityのトレースポイント例]<!--image-7.png-->

Visual StudioのデバッガをUnityにアタッチしてから、Unityを再生モードにしましょう。

[f:id:guitarrapc_tech:20260106180018p:plain:alt=Attach to Unity]<!--image-6.png-->

出力ウィンドウに設定したログが出力されます。コンパイル時間ゼロでログ出力できるようになりました。

[f:id:guitarrapc_tech:20260106180024p:plain:alt=出力ウィンドウへの出力例]<!--image-8.png-->

## 出力ウィンドウが流れてしまう

出力ウィンドウには、デフォルトではスレッドIDが出力され、あっという間に流れてしまいます。

[f:id:guitarrapc_tech:20260106180030p:plain:alt=デフォルトでスレッドIDが流れる]<!--image-10.png-->

特に、Unityにデバッグしていると頻繁にスレッドログが流れて邪魔なので、トレースログを見るときは非表示にするといいでしょう。
出力ウィンドウで右クリックして、Thread Exit Messages(スレッド終了メッセージ)のチェックを外します。

[f:id:guitarrapc_tech:20260106180038p:plain:alt=出力ウィンドウを右クリックしてThread Exit Messagesをオフにします]<!--image-9.png-->

出力ウィンドウの**時計アイコン**を有効にすると、出力時刻が表示されて便利なのでこちらもどうぞ

[f:id:guitarrapc_tech:20260106180045p:plain:alt=出力ウィンドウの時計アイコンを有効にする]<!--image-11.png-->

## キーワード

アクションにはキーワードを使えます。以下はMicrosoft Learnからの引用です。
この中で`$FUNCTION`や`$CALLSTACK`あたりはかなり便利でおすすめです。ブレークポイントで止めることなく関数名や呼び出し履歴をログに出せるのは強い。

| Keyword |	表示される内容 |
| --- | --- |
| `$ADDRESS` |	現在の命令 |
| `$CALLER` |	関数名の呼び出し |
| `$CALLSTACK` |	呼び出し履歴 |
| `$FUNCTION` |	現在の関数名 |
| `$PID` |	プロセス ID |
| `$PNAME` |	プロセス名 |
| `$TID` |	スレッド ID |
| `$TNAME` |	スレッド名 |
| `$TICK` |	ティック数 (Windows GetTickCount から) |


## 条件を付ける

**Conditions(条件)**でログを特定の条件でだけ出力できます。例えばループ処理で毎回ログが出るのはうざいですが、N回目のループだけログを出したい、という場合に便利です。

例えば以下のように、`i == 10`という条件を付けると、`i`が10のときだけログが出力されます。

[f:id:guitarrapc_tech:20260107033245p:plain:alt=条件の設定例]<!--image-12.png-->

出力ウィンドウを見ると、10回目のループでだけログが出力されていることがわかります。

[f:id:guitarrapc_tech:20260107033252p:plain:alt=出力ウィンドウの例]<!--image-13.png-->

**特定のブレークポイント**を通った時だけログを出すこともできます。これを使うと特定のコードパスを経由した呼び出しだけログを出せるため、呼び出し元が複数ある場合にめちゃめちゃ便利です。

[f:id:guitarrapc_tech:20260107033257p:plain:alt=ブレークポイントを条件にする]<!--image-14.png-->

## まとめ

Visual Studioのトレースポイントを使うと、コードを書き換えずにログを出力できます。
Riderに限らずVisual Studioにも同様の機能があるので、ぜひ試してみてください。

## 参考

- [トレースポイントを使用して情報をログに記録する - Visual Studio (Windows) | Microsoft Learn](https://learn.microsoft.com/ja-jp/visualstudio/debugger/using-tracepoints?view=visualstudio)
- [ログ1行のために、思考を止めない!Riderの「ブレークポイントログ」が破壊的に効く理由｜オオバ｜破壊的スピード開発](https://note.com/ohbashunsuke/n/n9ff12e7a1793)

[^1]: Visual Studio 2022でも同様です。
