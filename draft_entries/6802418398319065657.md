---
Title: WSL環境のCLIツールをasdfからaquaに移行する
Category:
- Ubuntu
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/6802418398319065657
PreviewURL: https://tech.guitarrapc.com/draft/entry/dh9_KsHxXcZnQfrhUlLdeLZn9qQ
---

私はWindowsでWSL Ubuntu環境を3つ動かしています。そのため、をインストール、アップグレードするにも手でやるのは面倒です。
これまでasdfを使ってツール管理していたのをaquaにした記録を書き出しておきます。

[:contents]

# asdfとaqua

asdfとaquaはともにCLIツールのバージョン管理ツールです。簡単に両者を見てみましょう。

**asdf**

[asdf](https://github.com/asdf-vm/asdf)は複数のランタイムバージョン管理、コマンドラインツールのバージョン管理ができるCLIです。asdfの特徴はプラグイン([asdf-vm/asdf-plugins)](https://github.com/asdf-vm/asdf-plugins))で、自分や誰かがCLIツールの定義をGitHubリポジトリに配置すると、asdf利用者はそれを参照して定義されたツールをインストールできます。

例えば、Node.jsをインストールするには次のようにします。

```sh
# asdfのnode.jsプラグインを追加
asdf plugin add nodejs https://github.com/asdf-vm/asdf-nodejs.git
# node.jsをインストール
asdf install nodejs latest
```

ツールのバージョンは`$HOME/.tool-versions`や`$PWD/.tool-versions`に保存されています。これを使ってグローバルやパス単位にツールバージョンを制御することができます。

```sh
# global version
asdf global nodejs lastest

# curent dir version
asdf local nodejs latest
```

**aqua**

[aqua](https://github.com/aquaproj/aqua)はコマンドラインツールのバージョン管理をするCLIです。aquaはインストールするツールをYAML定義し、[aquaproj/aqua-registry](https://github.com/aquaproj/aqua-registry)に配置されたツール定義を参照してCLIをインストールします。

例えば、Node.jsをインストールするには次のようにします。

```sh
# yaml定義を作成
aqua init
# yaml定義にnodejsを追加
aqua g -i nodejs/node
# インストール
aqua i  -l
```

## なぜaquaなのか

aquaがasdfと決定的に違うのはレジストリの存在です。

asdfのプラグインは、プラグイン定義が各自のリポジトリで管理されており、asdfから使うときにプラグインの定義が今どうなっているか気にする機会はまずありません。asdfプラグインを使うときに定義が変なことをしていないか精査することはあっても、その後プラグインが更新されるたびにチェックすることは困難です。[^1]

一方、aquaはレジストリがあり、ツールの定義がレジストリに集約されています。レジストリはツール定義の追加時にレビューし、ツール定義更新はRenovateがチェックサム付きで自動実行します。レジストリの品質が高く、ツール定義が公式に自動化込みでメンテされているというのはツールを使うときに安心できるポイントです。

![image](https://github.com/user-attachments/assets/4b6ab0b9-ee25-4983-87ff-6d7caabb1ab7)


[^1]: プラグインが更新されてもasdf上で利用前に気づくようなフローではないので自分で頑張るしかない
