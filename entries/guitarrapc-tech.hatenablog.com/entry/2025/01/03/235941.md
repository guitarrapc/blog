---
Title: 2024年を振り返って
Date: 2025-01-03T23:59:41+09:00
URL: https://tech.guitarrapc.com/entry/2025/01/03/235941
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/6802418398317142283
---

2023年の振り返りはさぼりましたが、2024年を振り返ります。前回の記事はこちら

> [2022年を振り返って](https://tech.guitarrapc.com/entry/2022/12/31/233012)

[:contents]

# 総合

2024年は、お手伝いしていた成果が世の中に出た年でした。喜ぶ人が観測できてよかったです。2025年も新しいことへのチャレンジに取り組んでいます。2025年は自社のために時間を捻出できそうなので形にしていきたいです。

インフラ的なお仕事は「サービス全般を一人で見るのは難しい」です。だからこそチームを作ってサービスを支えることが必要なのですが、2022年から課題ととらえてチームが育ちしっかり支えられています、チームに尊敬と感謝を改めて表明します。背景としてIaC 100％、CI/CDの整備が土台としてあります。IaCはプロジェクトの地力を高める、を証明できたので今後もよりよくなっていくように頑張ります。

2024年になってもわからないことが多く、何もわかっていないことを痛感します。ただ、ChatGPTをはじめとする生成AIを利用することで、これまで独力で試行錯誤していることに、壁打ちという武器を得ることができて開発イテレーションが早くなりました。生成AIを使うとこれまでの限界を超えることができるので、2025年もAIに置いて行かれないように学び続けたいです。

# 経営

2024年は外部への協力に注力しました。これは2025年から自社のサービスを立ち上げるための準備として当初から計画していたことです。無事に準備が整ったので、2025年は作りたかったものを自社で作っていく予定です。

# プログラミング

今年はC#メイン、HCL、Bashへ注力しました。

## `C#`

C# 13が出て、手元のコードの多くを.NET9に書き換えをしました。.NET8のCollection Expressionほどのインパクトがある変更はすくないですが、Spanを最優先でAPIをそろえていける手ごたえがあっていいですね。

> [What's new in C# 13](https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-13)

C#でずっとやりたいなぁと思っていたことに2024年は取り組んで、ある程度形になりました。いずれどこかで発表したいものです。2025年も宿題があるので、引き続きC#でやれなかったことに取り組んでいきたいです。

さて、C#言語機能そのものの改善もいいのですが、C#でZxを使っていける手ごたえを得られたのが大きい年でした。ようやくCIにおけるスクリプトをBashからC#への置き換え検討できそうです。つまり、ProcessXとConsoleAppFramework v5が欠かせない部品になりそうですね。

## Bash & PowerShell

この5年あまりはBashを使い倒しました。Bashはいいものです。ただ人によって書き方がバラバラすぎるので、チーム向けにスタイルガイドも作成しました。Googleのスタイルガイドを参考にしつつ、Bashの特性を生かしたスタイルガイドにしたつもりです。Bashをどう書くと挙動を安定させつつ、チームでメンテできるかを考えるのは楽しいです。

> [guitarrapc/bash-styleguide](https://github.com/guitarrapc/bash-styleguide)

この数年、PowerShellへ傾倒をした次のステップとしてBashにも同程度に傾倒する必要があると考えてやってきました。私が今後PowerShellをどう使っていくか考えるにあたり欠かせないチャレンジだからです。PowerShellで悩んでいたのは本ブログのPowerShell記事が減ったことでもわかる通りです。

改めてBashを考えてみましょう。BashはPowerShellとは違い、ネイティブコマンドと組み合わせたときに挙動を制御できるのが強みです。PowerShellはネイティブコマンドと組み合わせたときに挙動を制御できないのが弱みです。BashもPowerShell同様にコマンドを書き連ねたり2,3行書く分には悪くないのですが、それ以上のスクリプトを書くのは強く避けるべきと痛感しました。Bashでスクリプトを書くのはそれほど難しくないですが、それでもスクリプト言語として使うにはコマンドの挙動を理解する必要もあり難しいと言わざるを得ません。Zxに注目しているのはこのためです。

PowerShellの利用範囲を広げるためには、Bashのようにネイティブコマンドと組み合わせたときに挙動を制御できるようになる必要があると改めて感じました。たったの数行であってもネイティブコマンドが出た瞬間にPowerShellは候補から外れるざるを得ないのです。これがPowerShellを使おうにも、利用範囲を広げられない大きな原因でした。しかし2023年にリリースされたPowerShell 7.4で[PSNativeCommandErrorActionPreference](https://github.com/PowerShell/PowerShell/issues/20034)、[PSNativeCommandPreserveBytePipe](https://github.com/PowerShell/PowerShell/issues/19876)が入り、ネイティブコマンドとの組み合わせ課題が解消されました。PowerShellの利用範囲が広がり、クロスプラットフォームに使えるシェル、スクリプト言語のスタートラインに立ったわけです。2025年は、この新機能を踏まえたPowerShellの利用方法について紹介していきたいです。

> [What's New in PowerShell 7.4](https://learn.microsoft.com/en-us/powershell/scripting/whats-new/what-s-new-in-powershell-74?view=powershell-7.4)

なお、Windowsのデフォルトは今後もずっとWindows PowerShell 5.1のままでしょう。PowerShellが.NETをベースとする以上、LTSで3年程度の.NETと各OSのバランスを取るのは難しいからです。

> [PowerShell のサポート ライフサイクル](https://learn.microsoft.com/ja-jp/powershell/scripting/install/powershell-support-lifecycle?view=powershell-7.4)

なお、ちゃんとチームでメンテしていくならZxを最優先に検討したほうがいいと考えています。Goなどの任意のコマンドで書くことも同様に検討する派ですが、話がずれるのでそれはまた別の機会に。

## HCL

Terraformは多くの機能が入り、おおむねほしい機能が揃いました。特に`moved`/`import`/`removed`ブロックは、コードから`terraform state`を制御できるようになるのでワークフロー革命と言えます。インフラのリファクタリングをPR+CIで完結できるようになったので、`terraform state`を使っているのであれば早くTerraform 1.10にアップグレードしてやり方を変えましょう。`terraform state`を実行するのは事故の原因です。

Terraformの運用は悩ましいものがありますが、やはりモジュールに実装を押し込める手法が最も安全で運用しやすいと感じています。Terraformのモジュールはクラスと捉えることができ、モジュールは循環参照できません。このため、モジュールのvariables/outputsを適切に設計すると、コード間の依存関係を明確に制御できます。モジュールの外に関心が漏れることもなくなります。Terraformのコード設計によって循環参照をなくせるのは、インフラを維持、改善するにあたり大きなメリットです。チームに対する説明もしやすく、コードレビューもしやすく、コード品質の維持管理もしやすくなります。

Terraformは新サービスやプロバイダーの追加が早い一方、世の中のリリースはもっと早いので追いつけていないと感じます。IaCもそろそろ次のステージに行けるといいですね。例えばCrossplaneのようにKubernetesからクラウドをすべて管理するのは違うと感じますが、aws-controllers-k8sのようにKubernetesから一部クラウドリソースを管理するのはありですし、Terraformの次にも注目していきたいです。

> [Crossplane](https://github.com/crossplane/crossplane)
> [aws-controllers-k8s](https://github.com/aws-controllers-k8s)

# 記事

2本、過去最少!今年は毎日更新したい謎の欲求があります。頑張りましょう。

# ライフスタイル

コロナが収束している気が一切しないので、マスク生活をやめていません。2024年についに罹患したのですが、発症前にラーメンを食べているときに隣の席のお客さんが咳をしていたので、その時罹患したと推測しています。幸いにして、手洗い、マスクをしてから体調を崩しにくくなったので、これからも衛生には気を付けて続けていきたいです。

# 2025年は?

PowerShellの新しい利用を紹介していきたいです。Terraformでいくつか実践的に投下したいものがあるので、それも試したいです。C#でもいくつか書きたいライブラリがあるので書いていきたいところです。

やりたいこといっぱいですね、頑張りましょう。
