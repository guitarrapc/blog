---
Title: pwshで予測機能を選択する
Category:
- PowerShell
Date: 2025-12-09T23:00:00+09:00
URL: https://tech.guitarrapc.com/entry/2025/12/09/230000
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/17179246901330420108
---

PowerShell 7.1にはPSReadLine 2.1が搭載されています。PSReadLineはこのバージョンから予測機能をサポートしており、シェルで次に入力する内容を予測してグレイアウト表示します。
こういうグレイアウトされたプレースホルダー表示、見たことないでしょうか?

[f:id:guitarrapc_tech:20251210031242p:plain:alt=予測候補の表示例]<!-- image.png -->

今回はこのメモです。

[:contents]

## 予測候補を選択する

予測機能が出ていてもTabキーを押しても現在ディレクトリのファイルが候補に出るだけで「予測候補を選べません」、なんだと。
このため、予測候補度を選びたいなーと思いつつなぞるように入力するとかいう雑なことをしていました。

[f:id:guitarrapc_tech:20251210032644g:plain:alt=予測候補に沿って入力している]<!-- input.gif -->

予測候補を選択するには「右矢印キー」を押してください。

[f:id:guitarrapc_tech:20251210032719g:plain:alt=予測候補を選択する]<!-- input-1.gif -->

以上、この記事を書いた動機でした。

## 予測候補の詳細

[Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/scripting/learn/shell/using-predictors?view=powershell-7.5)にいい感じの記事があるので、これを見ると良いでしょう。

予測候補は仮想ターミナル(VT)がサポートされいて、PowerShell 7.2以降ならデフォルト有効です。VTは、Windows TerminalやVS Codeのターミナル、WSL、macOSのターミナルアプリなどでサポートされています。
ということで、Windows 11 25H2以降であれば、PowerShell 7.4をインストールしたらすぐに使えます。

もしも予測候補が出ない場合は、以下のコマンドで予測機能が有効になっているか確認してください。

```ps1
Get-PSReadLineOption | Select-Object -Property PredictionSource
```

また、もしインストールされていない場合、次のコマンドで最新のPSReadLineをインストールしてください。

```ps1
Install-PSResource -Name PSReadLine
```

色やキーバインド変更も可能ですが、私はデフォルトのまま使っているので詳細はMicrosoft Learnで。


## まとめ

候補はTabキーで選ぶというのがシェルの常識だと思い込んでいていました。まさか右矢印キーなんですね。

## 参考資料

- [Announcing PSReadLine 2.1+ with Predictive IntelliSense | PowerShell Team](https://devblogs.microsoft.com/powershell/announcing-psreadline-2-1-with-predictive-intellisense/)
- [PSReadLine での予測変数の使用 - PowerShell | Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/scripting/learn/shell/using-predictors?view=powershell-7.5)
- [PowerShell 7.4 の新機能 - PowerShell | Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/scripting/whats-new/what-s-new-in-powershell-74?view=powershell-7.5)
