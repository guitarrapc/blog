---
Title: PowerShellでSubstitute(変数代入)、Host(ホスト出力)、Content(ファイル出力)するコストのベンチマーク
Category:
- PowerShell
Date: 2013-03-11T03:03:19+09:00
URL: https://tech.guitarrapc.com/entry/2013/03/11/030319
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/11696248318757675548
CustomPath: 2013/03/11/030319_2
---

<p>どうも、ベンチマーク厨です。 いや、そうではないのですが、コマンドレットはAutomationしているわけで中々内側が見えません。 実際、同じような利用ができるコマンドレットは多く、スピード的な一面も押さえておいて損はないと思います。 そこで、今回は、前回の前提を基に引き続きベンチマークを取ってみます。</p>
<blockquote>日本語記事: <a href="http://guitarrapc.wordpress.com/2013/03/09/powershell%e3%81%a7for-foreach-foreach-object-scriptblock-filter%e3%81%ae%e3%83%99%e3%83%b3%e3%83%81%e3%83%9e%e3%83%bc%e3%82%af/" target="_blank">PowerShellでFor / Foreach / Foreach-Object / ScriptBlock / Filterのベンチマーク</a></blockquote>
<blockquote>English Article: <a href="http://guitarrapc.wordpress.com/2013/03/10/powershell-for-foreach-foreach-object-scriptblock-filter-benchmark-2013/" target="_blank">PowerShell For / Foreach / Foreach-Object / ScriptBlock / Filter – Benchmark 2013</a></blockquote>
<h2>はじめに</h2>
<p>今回のお題目は…これらのコストはいかほどかです。</p>
<blockquote>変数への代入 (Substitute/Assign to the variable) ホスト画面出力 (Host Output) ファイル出力 (File Output)</blockquote>
<p>本来ならPowerShell 1.0, 2.0の結果も併記するべきなのでしょうが、PowerShell 3.0のみです。 どうかご了承下さい。</p>
<h2>測定対象</h2>
<p>前回同様、<code>for</code>と<code>foreach</code>以外にも多用される、<code>Foreach-Object</code>コマンドレット、<code>ScriptBlock</code>、<code>filter</code>を対象に測定しています。</p>
<pre class="brush: powershell">for
foreach
Foreach-Object
ScriptBlock
Filter
</pre>
<p>いわずとしてれますが、PowerShellで利用する際はこのような感じです。</p>
<pre class="brush: powershell">for (&lt;初期化パイプライン&gt;; &lt;評価パイプライン&gt;;&lt;インクリメントパイプライン&gt;){&lt;文リスト&gt;}
foreach (&lt;変数&gt; in &lt;ループにかけるパイプライン&gt;){&lt;文リスト&gt;}
&lt;パラメータ&gt; | Foreach-Object {begin}{process}{end}
&amp;{文リスト}
filter &lt;名前&gt;{param(&lt;パラメーターリスト&gt;) &lt;文リスト&gt;}
</pre>
<p>そして今回は各ループ処理に以下のソースを追加してコストが変わるかでベンチを取ります。</p>
<pre class="brush: powershell">$hoge = $total # 変数への代入
$Global:hoge = $total # グローバル変数への代入

Write-Host $total # ホスト画面出力
[console]::WriteLine("$total") # .Netを利用ホスト画面出力

$total | Out-File # ファイル出力
Add-Content -Value $total # ファイル出力
</pre>
<h2>ベンチマーク結果</h2>
<p>前回の記事で、コレクション長によって指数関数的にコストが増えるわけではないことが分かっています。 そこで、コレクション長は10000とします。</p>
<blockquote>計測単位 : miliseconds コレクション長 : 10000</blockquote>
<h3>変数代入</h3>
<ol>
<li>None : 前回同様$totalにコレクションを足す以外、何もしていないベースの状態です。</li>
<li>Substitute : Noneに加えて、子スコープのままで変数に代入</li>
<li>Substitute_Global : Noneに加えて、グローバル変数を呼び出し子スコープ変数を代入</li>
</ol>
<table border="0" width="697" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td align="left" width="94" height="21">Data Type</td>
<td align="left" width="141">Collection Type</td>
<td align="left" width="133">Loop Type</td>
<td align="left" width="71">None</td>
<td align="left" width="95">Substitute</td>
<td align="left" width="163">Substitute_Global</td>
</tr>
<tr>
<td rowspan="15" height="315">int</td>
<td rowspan="5">int[]</td>
<td align="left">For</td>
<td align="right">137.41</td>
<td align="right">170.92</td>
<td align="right">169.46</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">91.28</td>
<td align="right">116.00</td>
<td align="right">115.36</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">580.89</td>
<td align="right">643.32</td>
<td align="right">648.66</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">113.65</td>
<td align="right">129.87</td>
<td align="right">144.46</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.12</td>
<td align="right">133.95</td>
<td align="right">147.32</td>
</tr>
<tr>
<td rowspan="5" height="105">List&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">201.78</td>
<td align="right">225.60</td>
<td align="right">232.92</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">144.20</td>
<td align="right">163.92</td>
<td align="right">174.82</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">636.81</td>
<td align="right">700.66</td>
<td align="right">736.98</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">174.52</td>
<td align="right">195.21</td>
<td align="right">202.49</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">174.17</td>
<td align="right">182.78</td>
<td align="right">208.25</td>
</tr>
<tr>
<td rowspan="5" height="105">ArrayList&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">144.24</td>
<td align="right">162.28</td>
<td align="right">171.57</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">88.62</td>
<td align="right">107.99</td>
<td align="right">114.61</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">561.38</td>
<td align="right">599.04</td>
<td align="right">619.76</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">111.93</td>
<td align="right">126.38</td>
<td align="right">139.84</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.02</td>
<td align="right">122.40</td>
<td align="right">139.32</td>
</tr>
<tr>
<td colspan="3" height="21">Average</td>
<td align="right">226.07</td>
<td align="right">252.02</td>
<td align="right">264.39</td>
</tr>
</tbody>
</table>
<h3>ホスト出力</h3>
<ol>
<li>None : 前回同様$totalにコレクションを足す以外、何もしていないベースの状態です。</li>
<li>Write-Output(Object) : Write-OutputコマンドレットでObject出力された場合 (本コマンドレットは状況に応じて自動的にObject出力とHost出力が切り替わります)</li>
<li>Write-Output() : Write-Outputコマンドレットでホスト画面に出力</li>
<li>Write-Host : Write-Hostコマンドレットでホスト画面に出力</li>
<li>Console::Write : [System.Console]::WriteLineメソッドでホスト画面に出力</li>
</ol>
<table border="0" width="648" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td align="left" width="81" height="21">Data Type</td>
<td align="left" width="81">Collection Type</td>
<td align="left" width="81">Loop Type</td>
<td align="left" width="81">None</td>
<td align="left" width="81">Write-Output(Object)</td>
<td align="left" width="81">Write-Output(Host)</td>
<td align="left" width="81">Write-Host</td>
<td align="left" width="81">Console::Write</td>
</tr>
<tr>
<td rowspan="15" height="315">int</td>
<td rowspan="5">int[]</td>
<td align="left">For</td>
<td align="right">137.41</td>
<td align="right">1587.95</td>
<td align="right">6380.74</td>
<td align="right">6352.40</td>
<td align="right">2261.77</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">91.28</td>
<td align="right">1513.34</td>
<td align="right">6563.93</td>
<td align="right">5844.37</td>
<td align="right">2120.81</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">580.89</td>
<td align="right">2204.04</td>
<td align="right">7007.28</td>
<td align="right">7469.18</td>
<td align="right">2915.34</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">113.65</td>
<td align="right">1623.87</td>
<td align="right">6133.83</td>
<td align="right">6183.97</td>
<td align="right">2196.14</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.12</td>
<td align="right">1620.46</td>
<td align="right">6195.55</td>
<td align="right">6071.62</td>
<td align="right">2275.90</td>
</tr>
<tr>
<td rowspan="5" height="105">List&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">201.78</td>
<td align="right">1710.05</td>
<td align="right">6380.76</td>
<td align="right">6166.34</td>
<td align="right">2364.22</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">144.20</td>
<td align="right">1623.27</td>
<td align="right">6396.59</td>
<td align="right">6123.73</td>
<td align="right">2261.01</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">636.81</td>
<td align="right">2278.93</td>
<td align="right">7092.62</td>
<td align="right">7269.10</td>
<td align="right">3043.07</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">174.52</td>
<td align="right">1744.01</td>
<td align="right">6552.76</td>
<td align="right">6512.89</td>
<td align="right">2360.54</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">174.17</td>
<td align="right">1750.13</td>
<td align="right">6462.41</td>
<td align="right">6407.75</td>
<td align="right">2324.75</td>
</tr>
<tr>
<td rowspan="5" height="105">ArrayList&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">144.24</td>
<td align="right">1588.09</td>
<td align="right">6281.62</td>
<td align="right">5829.04</td>
<td align="right">2217.66</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">88.62</td>
<td align="right">1511.92</td>
<td align="right">6022.70</td>
<td align="right">5700.31</td>
<td align="right">2088.57</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">561.38</td>
<td align="right">2173.55</td>
<td align="right">6742.15</td>
<td align="right">6741.88</td>
<td align="right">2896.07</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">111.93</td>
<td align="right">1603.57</td>
<td align="right">6052.65</td>
<td align="right">5969.21</td>
<td align="right">2155.02</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.02</td>
<td align="right">1607.19</td>
<td align="right">5956.31</td>
<td align="right">5797.68</td>
<td align="right">2198.74</td>
</tr>
<tr>
<td colspan="3" height="20">Average</td>
<td align="right">226.07</td>
<td align="right">1742.69</td>
<td align="right">6414.79</td>
<td align="right">6295.97</td>
<td align="right">2378.64</td>
</tr>
</tbody>
</table>
<h3>ファイル出力</h3>
<ol>
<li>None : 前回同様$totalにコレクションを足す以外、何もしていないベースの状態です。</li>
<li>SetContent: AddContentコマンドレットでファイルに追記出力</li>
<li>OutFile : Out-Fileコマンドレットでファイルに追記出力</li>
</ol>
<table border="0" width="621" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td align="left" width="94" height="21">Data Type</td>
<td align="left" width="141">Collection Type</td>
<td align="left" width="133">Loop Type</td>
<td align="left" width="71">None</td>
<td align="left" width="102">SetContent</td>
<td align="left" width="80">OutFile</td>
</tr>
<tr>
<td rowspan="15" height="315">int</td>
<td rowspan="5">int[]</td>
<td align="left">For</td>
<td align="right">137.41</td>
<td align="right">9109.02</td>
<td align="right">9126.99</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">91.28</td>
<td align="right">9005.38</td>
<td align="right">9016.87</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">580.89</td>
<td align="right">9476.49</td>
<td align="right">9822.08</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">113.65</td>
<td align="right">8977.33</td>
<td align="right">9128.05</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.12</td>
<td align="right">9147.63</td>
<td align="right">9187.12</td>
</tr>
<tr>
<td rowspan="5" height="105">List&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">201.78</td>
<td align="right">9078.84</td>
<td align="right">9272.52</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">144.20</td>
<td align="right">9188.92</td>
<td align="right">8990.75</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">636.81</td>
<td align="right">9463.82</td>
<td align="right">9673.35</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">174.52</td>
<td align="right">9198.39</td>
<td align="right">9159.49</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">174.17</td>
<td align="right">9143.69</td>
<td align="right">9151.33</td>
</tr>
<tr>
<td rowspan="5" height="105">ArrayList&lt;int&gt;</td>
<td align="left">For</td>
<td align="right">144.24</td>
<td align="right">8979.03</td>
<td align="right">8704.22</td>
</tr>
<tr>
<td align="left" height="21">Foreach</td>
<td align="right">88.62</td>
<td align="right">9109.20</td>
<td align="right">8613.43</td>
</tr>
<tr>
<td align="left" height="21">Foreach-Object</td>
<td align="right">561.38</td>
<td align="right">9534.32</td>
<td align="right">9202.77</td>
</tr>
<tr>
<td align="left" height="21">ScriptBlock</td>
<td align="right">111.93</td>
<td align="right">9173.08</td>
<td align="right">8715.47</td>
</tr>
<tr>
<td align="left" height="21">Filter</td>
<td align="right">115.02</td>
<td align="right">9194.50</td>
<td align="right">8880.19</td>
</tr>
<tr>
<td colspan="3" height="21">Average</td>
<td align="right">226.07</td>
<td align="right">9185.31</td>
<td align="right">9109.64</td>
</tr>
</tbody>
</table>
<h2>結果</h2>
<p>それでは、全体の結果を見てみます。</p>
<h3>コレクション別速度順位</h3>
<p>いずれも、コレクションを直接処理した前回に比べるとループ処理によるコストの差は大幅に縮んでいます。 これはもう、ほど無視できるレベルと言えるかと思います。 foreach v.s. Foreach-Objectで見てみましょう。</p>
<blockquote>
<ol>
<li>変数代入では、、3～4倍程度です。</li>
<li>ホスト出力では、1.2倍～1.4倍程度です。</li>
<li>ファイル出力では、1.05倍程度です。</li>
</ol>
</blockquote>
<ol>
<li>ArrayList (Fastest)</li>
<li>int[]</li>
<li>List (Slowest)</li>
</ol>
<h3>Data Type別 Loop操作</h3>
<p>これもループタイプと同様に、コレクションを直接処理した前回に比べるとデータタイプによるコストの差は大幅に縮んでいます。 int[]とArrayListでも、もはや1割程度の違いです。</p>
<ul>
<li><strong>int[] (Array)</strong></li>
<li><strong>List</strong></li>
<li><strong>ArrayList</strong></li>
</ul>
<p>Racioから特筆すべきは、Foreach-Objectが、コマンド毎のコストの違いに差が小さい事です。 元々のコマンドのコストが高いこともありますが、Foreach-Objectの特徴である利用メモリの小ささが要因にありそうですね。</p>
<h3>各操作のコスト</h3>
<p>代入、ホスト出力、ファイル出力のそれぞれをみてみましょう。</p>
<h4>代入 - Substitute/Assign</h4>
<blockquote>代入のコストは、何もしない場合(None)の1～2割程度と非常に小さいですね。 子スコープでの代入、グローバル変数への代入はほぼ変わりませんでした。</blockquote>
<h4>ホスト出力 - Host Output</h4>
<blockquote>ホスト出力は、何もしない場合(None)に比べ大幅にコストが高まることが分かります。 対Write-Output(Object)は、ホスト画面出力が無い分5-10倍前後です。 対Write-Output(Host)は、ホスト画面出力をしており、25-30倍前後です。 対Write-Hostで、なんと25～30倍前後です。 対[System.Console]::WriteLine()で、5～10倍前後です。 また、Write-Outputに比べて、Write-Hostのコストがわずかですが低いようですね。 特に[System.Console]::WriteLine()は、Write-Hostに比べて1/3程度のコストを示す場合もあり、非常に早いことが分かります。</blockquote>
<h4>ファイル出力 - File Output</h4>
<blockquote>ファイル出力は、何もしない場合(None)に比べホスト出力以上にコストがかかることが分かります。 また、Add-Content(Set-Content)でも、Out-Fileでもコストはほぼ同一です。 Noneに対して、70倍前後です。 また、他のコマンドと異なり、DataTypeやLoop Typeにかかわらずほぼ一定のコストのようにも見えます。 ※多少、Foreach-Objectが遅いようですが。 これは、Out-Fileがパイプを介していることを考えるとパイプのコストは意外と小さい可能性がありますね。</blockquote>
<h2>テストに利用したコード</h2>
<p>何もしていない基準となるNoneのコードです。</p>
<pre class="brush: powershell">filter Get-FilterTest{

        [decimal]$total += $_
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
        }
    }

}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{process{[decimal]$total += $_}}
    }

}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{process{[decimal]$total += $_}}
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{process{[decimal]$total += $_}}
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

1..4 | ForEach-Object {
(Get-intForTest -int $array).TotalMilliseconds
(Get-intForeachTest -int $array).TotalMilliseconds
(Get-intForeachObjectTest -int $array).TotalMilliseconds
(Get-intScriptBlockTest -int $array).TotalMilliseconds
(Get-intFilterTest -int $array).TotalMilliseconds

(Get-ListForTest -int $array).TotalMilliseconds
(Get-ListForeachTest -int $array).TotalMilliseconds
(Get-ListForeachObjectTest -int $array).TotalMilliseconds
(Get-ListScriptBlockTest -int $array).TotalMilliseconds
(Get-ListFilterTest -int $array).TotalMilliseconds

(Get-ArrayListForTest -int $array).TotalMilliseconds
(Get-ArrayListForeachTest -int $array).TotalMilliseconds
(Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds
(Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds
(Get-ArrayListFilterTest -int $array).TotalMilliseconds
""
}
</pre>
<h3>代入</h3>
<p>子スコープのまま代入のコードです</p>
<pre class="brush: powershell">filter Get-FilterTest{

        [decimal]$total += $_
        $hoge = $total
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            $hoge = $total
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            $hoge = $total
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            $hoge = $total
        }
    }

}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                $hoge = $total
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            $hoge = $total
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            $hoge = $total
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            $hoge = $total
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                $hoge = $total
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            $hoge = $total
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            $hoge = $total
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            $hoge = $total
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                $hoge = $total
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

1..4 | ForEach-Object {
(Get-intForTest -int $array).TotalMilliseconds
(Get-intForeachTest -int $array).TotalMilliseconds
(Get-intForeachObjectTest -int $array).TotalMilliseconds
(Get-intScriptBlockTest -int $array).TotalMilliseconds
(Get-intFilterTest -int $array).TotalMilliseconds

(Get-ListForTest -int $array).TotalMilliseconds
(Get-ListForeachTest -int $array).TotalMilliseconds
(Get-ListForeachObjectTest -int $array).TotalMilliseconds
(Get-ListScriptBlockTest -int $array).TotalMilliseconds
(Get-ListFilterTest -int $array).TotalMilliseconds

(Get-ArrayListForTest -int $array).TotalMilliseconds
(Get-ArrayListForeachTest -int $array).TotalMilliseconds
(Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds
(Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds
(Get-ArrayListFilterTest -int $array).TotalMilliseconds
""
}
</pre>
<p>親スコープへ代入のコードです</p>
<pre class="brush: powershell">filter Get-FilterTest{

        [decimal]$total += $_
        $Global:hoge = $total
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            $Global:hoge = $total
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            $Global:hoge = $total
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            $Global:hoge = $total
        }
    }

}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                $Global:hoge = $total
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            $Global:hoge = $total
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            $Global:hoge = $total
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            $Global:hoge = $total
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                $Global:hoge = $total
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            $Global:hoge = $total
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            $Global:hoge = $total
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            $Global:hoge = $total
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                $Global:hoge = $total
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

$hoge = $null

1..4 | ForEach-Object {
(Get-intForTest -int $array).TotalMilliseconds
(Get-intForeachTest -int $array).TotalMilliseconds
(Get-intForeachObjectTest -int $array).TotalMilliseconds
(Get-intScriptBlockTest -int $array).TotalMilliseconds
(Get-intFilterTest -int $array).TotalMilliseconds

(Get-ListForTest -int $array).TotalMilliseconds
(Get-ListForeachTest -int $array).TotalMilliseconds
(Get-ListForeachObjectTest -int $array).TotalMilliseconds
(Get-ListScriptBlockTest -int $array).TotalMilliseconds
(Get-ListFilterTest -int $array).TotalMilliseconds

(Get-ArrayListForTest -int $array).TotalMilliseconds
(Get-ArrayListForeachTest -int $array).TotalMilliseconds
(Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds
(Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds
(Get-ArrayListFilterTest -int $array).TotalMilliseconds
""
}
</pre>
<h3>ホスト出力</h3>
<p>Write-Outputでオブジェクト出力のコードです</p>
<pre class="brush: powershell">function Measure-Stopwatch{

    [CmdletBinding()]
    param(
    [parameter(Mandatory=$true)]
    [ScriptBlock]$Command,
    [switch]$Days,
    [switch]$Hours,
    [switch]$Minutes,
    [switch]$Seconds,
    [switch]$Milliseconds
    )

    function Start-InputScriptBlock {
        $sw = New-Object System.Diagnostics.StopWatch

        # Start Stopwatch
        $sw.Start()

        #TargetCommand to measure
        $command.Invoke()

        # Stop Stopwatch
        $sw.Stop()

        #Show Result
        switch ($true){
        $Days {$sw.Elapsed.TotalDays}
        $Hours {$sw.Elapsed.TotalHours}
        $Minutes {$sw.Elapsed.TotalMinutes}
        $Seconds {$sw.Elapsed.TotalSeconds}
        $Milliseconds {$sw.Elapsed.TotalMilliseconds}
        default {$sw.Elapsed}
        }

        #Reset Result
        $sw.Reset()
    }

    Start-InputScriptBlock
}

filter Get-FilterTest{

        [decimal]$total += $_
        Write-Output $total
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Stopwatch -Command {
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            Write-Output $total
        }
    } -Milliseconds

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Stopwatch -Command {
        foreach ($i in $int)
        {
            [decimal]$total += $i
            Write-Output $total
        }
    } -Milliseconds

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            Write-Output $total
        }
    } -Milliseconds
}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    } -Milliseconds
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | Get-FilterTest
    } -Milliseconds
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    } -Milliseconds
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
        $list | Get-FilterTest
    } -Milliseconds
}


function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            Write-Output $total
        }
    } -Milliseconds
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    } -Milliseconds
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Stopwatch -Command {
	    $arrayList | Get-FilterTest
    } -Milliseconds
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

$result=@()


1..4 | ForEach-Object {
$result += Get-intForTest -int $array | select -last 1
$result += Get-intForeachTest -int $array | select -last 1
$result += Get-intForeachObjectTest -int $array | select -last 1
$result += Get-intScriptBlockTest -int $array | select -last 1
$result += Get-intFilterTest -int $array | select -last 1

$result += Get-ListForTest -int $array | select -last 1
$result += Get-ListForeachTest -int $array | select -last 1
$result += Get-ListForeachObjectTest -int $array | select -last 1
$result += Get-ListScriptBlockTest -int $array | select -last 1
$result += Get-ListFilterTest -int $array | select -last 1

$result += Get-ArrayListForTest -int $array | select -last 1
$result += Get-ArrayListForeachTest -int $array | select -last 1
$result += Get-ArrayListForeachObjectTest -int $array | select -last 1
$result += Get-ArrayListScriptBlockTest -int $array | select -last 1
$result += Get-ArrayListFilterTest -int $array | select -last 1
$result += ""
}
$result
</pre>
<p>Write-Outputでホスト出力のコードです</p>
<pre class="brush: powershell">function Measure-Stopwatch{

    [CmdletBinding()]
    param(
    [parameter(Mandatory=$true)]
    [ScriptBlock]$Command,
    [switch]$Days,
    [switch]$Hours,
    [switch]$Minutes,
    [switch]$Seconds,
    [switch]$Milliseconds
    )

    function Start-InputScriptBlock {
        $sw = New-Object System.Diagnostics.StopWatch

        # Start Stopwatch
        $sw.Start()

        #TargetCommand to measure
        $command.Invoke()

        # Stop Stopwatch
        $sw.Stop()

        #Show Result
        switch ($true){
        $Days {$sw.Elapsed.TotalDays}
        $Hours {$sw.Elapsed.TotalHours}
        $Minutes {$sw.Elapsed.TotalMinutes}
        $Seconds {$sw.Elapsed.TotalSeconds}
        $Milliseconds {$sw.Elapsed.TotalMilliseconds}
        default {$sw.Elapsed}
        }

        #Reset Result
        $sw.Reset()
    }

    Start-InputScriptBlock
}

filter Get-FilterTest{

        [decimal]$total += $_
        Write-Output $total
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Stopwatch -Command {
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            Write-Output $total
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Stopwatch -Command {
        foreach ($i in $int)
        {
            [decimal]$total += $i
            Write-Output $total
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            Write-Output $total
        }
    }
}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Stopwatch -Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            Write-Output $total
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            Write-Output $total
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            Write-Output $total
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Stopwatch -Command{
        $list | Get-FilterTest
    }
}


function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            Write-Output $total
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            Write-Output $total
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            Write-Output $total
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Stopwatch -Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                Write-Output $total
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Stopwatch -Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

$result=@()


1 | ForEach-Object {
Get-intForTest -int $array
Get-intForeachTest -int $array
Get-intForeachObjectTest -int $array
Get-intScriptBlockTest -int $array
Get-intFilterTest -int $array

Get-ListForTest -int $array
Get-ListForeachTest -int $array
Get-ListForeachObjectTest -int $array
Get-ListScriptBlockTest -int $array
Get-ListFilterTest -int $array

Get-ArrayListForTest -int $array
Get-ArrayListForeachTest -int $array
Get-ArrayListForeachObjectTest -int $array
Get-ArrayListScriptBlockTest -int $array
Get-ArrayListFilterTest -int $array
""
}
</pre>
<p>Write-Hostのコードです</p>
<pre class="brush: powershell">filter Get-FilterTest{

        [decimal]$total += $_
        Write-Host $total
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            Write-Host $total
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            Write-Host $total
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            Write-Host $total
        }
    }

}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                Write-Host $total
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            Write-Host $total
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            Write-Host $total
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            Write-Host $total
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                Write-Host $total
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            Write-Host $total
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            Write-Host $total
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            Write-Host $total
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                Write-Host $total
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

$result=@()

1..4 | ForEach-Object {
$result += (Get-intForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intFilterTest -int $array).TotalMilliseconds | Select -Last 1

$result += (Get-ListForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListFilterTest -int $array).TotalMilliseconds | Select -Last 1

$result += (Get-ArrayListForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListFilterTest -int $array).TotalMilliseconds | Select -Last 1
$result += ""
}
$result
</pre>
<p>[System.Console]::Console()のコードです</p>
<pre class="brush: powershell">filter Get-FilterTest{

        [decimal]$total += $_
        [console]::WriteLine("$total")
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            [console]::WriteLine("$total")
        }
    }

}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            [console]::WriteLine("$total")
        }
    }

}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            [console]::WriteLine("$total")
        }
    }

}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                [console]::WriteLine("$total")
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            [console]::WriteLine("$total")
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            [console]::WriteLine("$total")
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            [console]::WriteLine("$total")
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                [console]::WriteLine("$total")
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            [console]::WriteLine("$total")
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            [console]::WriteLine("$total")
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            [console]::WriteLine("$total")
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                [console]::WriteLine("$total")
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

$result=@()

1..4 | ForEach-Object {
$result += (Get-intForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-intFilterTest -int $array).TotalMilliseconds | Select -Last 1

$result += (Get-ListForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ListFilterTest -int $array).TotalMilliseconds | Select -Last 1

$result += (Get-ArrayListForTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListForeachTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds | Select -Last 1
$result += (Get-ArrayListFilterTest -int $array).TotalMilliseconds | Select -Last 1
$result += ""
}
$result
</pre>
<h3>ファイル出力</h3>
<p>Add-Contentのコードです</p>
<pre class="brush: powershell">if ((Test-Path -Path .\Temp) -eq $false)
{
    New-Item -ItemType Directory -Path .\Temp
}
elseif ((Test-Path -Path .\Temp\test.txt) -eq $true)
{
    Remove-Item .\temp\test.txt
}

filter Get-FilterTest{

        [decimal]$total += $_
        Add-Content -Value $total -Path .\Temp\test.txt
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                Add-Content -Value $total -Path .\Temp\test.txt
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                Add-Content -Value $total -Path .\Temp\test.txt
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            Add-Content -Value $total -Path .\Temp\test.txt
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                Add-Content -Value $total -Path .\Temp\test.txt
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

1..4 | ForEach-Object {
(Get-intForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5
""
}
</pre>
<p>Out-Fileのコードです</p>
<pre class="brush: powershell">if ((Test-Path -Path .\Temp) -eq $false)
{
    New-Item -ItemType Directory -Path .\Temp
}
elseif ((Test-Path -Path .\Temp\test.txt) -eq $true)
{
    Remove-Item .\temp\test.txt
}

filter Get-FilterTest{

        [decimal]$total += $_
        $total | Out-File -FilePath .\Temp\test.txt -Append
}

function Get-intForTest{

    param(
    $int
    )

    Measure-Command{
        for ($i = 0; $i -lt $int.length; $i++)
        {
            [decimal]$total += $int[$i]
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-intForeachTest{

    param(
    $int
    )

    Measure-Command{
        foreach ($i in $int)
        {
            [decimal]$total += $i
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-intForeachObjectTest{

    param(
    $int
    )

    Measure-Command{
        $int | ForEach-Object{
            [decimal]$total += $_
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-intScriptBlockTest{

    param(
    $int
    )

    Measure-Command{
        $int | &amp;{
            process{
                [decimal]$total += $_
                $total | Out-File -FilePath .\Temp\test.txt -Append
            }
        }
    }
}

function Get-intFilterTest{

    param(
    $int
    )

    Measure-Command{
        $int | Get-FilterTest
    }
}

function Get-ListForTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $list[$i]
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ListForeachTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    foreach ($l in $list)
        {
    	    [decimal]$total += $l
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ListForeachObjectTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | foreach-Object{
    	    [decimal]$total += $_
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ListScriptBlockTest{

	param(
	$int
	)

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
	    $list | &amp;{
            process{
                [decimal]$total += $_
                $total | Out-File -FilePath .\Temp\test.txt -Append
            }
        }
    }
}

function Get-ListFilterTest{
    param(
    $int
    )

	$list  = New-Object 'System.Collections.Generic.List`1[System.String]'

	$int | foreach-Object { $list.Add($_)}

	#,$list

    Measure-Command{
        $list | Get-FilterTest
    }
}

function Get-ArrayListForTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    for ($i = 0; $i -lt $int.length; $i++)
        {
    	    [decimal]$total += $arrayList[$i]
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ArrayListForeachTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    foreach ($al in $arrayList)
        {
    	    [decimal]$total += $al
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ArrayListForeachObjectTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | Foreach-Object{
    	    [decimal]$total += $_
            $total | Out-File -FilePath .\Temp\test.txt -Append
        }
    }
}

function Get-ArrayListScriptBlockTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist

    Measure-Command{
	    $arrayList | &amp;{
            process{
                [decimal]$total += $_
                $total | Out-File -FilePath .\Temp\test.txt -Append
            }
        }
    }
}

filter Get-ArrayListFilterTest{
    param(
    $int
    )

	$arrayList = New-Object System.Collections.ArrayList

	[Void]($int | foreach-Object { $arrayList.Add($_) })

	#,$Arraylist
	Measure-Command {
	    $arrayList | Get-FilterTest
    }
}

[int[]]$array=@()
#$array += 1..30000000
$array += 1..10000

1..4 | ForEach-Object {
(Get-intForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-intFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ListFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForeachTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListForeachObjectTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListScriptBlockTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5

(Get-ArrayListFilterTest -int $array).TotalMilliseconds
Remove-Item .\temp\test.txt
sleep -Seconds 5
""
}
</pre>
<h2>ライセンス</h2>
<p>本記事のソースコードやファイルは、元サイト同様に<a href="http://www.codeproject.com/info/cpol10.aspx" target="_blank">The Code Project Open License (CPOL)</a>とします。</p>
