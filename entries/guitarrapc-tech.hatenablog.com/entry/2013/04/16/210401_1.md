---
Title: PowerShellで所定のWindows Updateがインストールされているか確認する
Category:
- PowerShell
Date: 2013-04-16T21:04:01+09:00
URL: https://tech.guitarrapc.com/entry/2013/04/16/210401_1
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/6802418398340690972
---

<!--
Date: 2013-04-16T21:04:01+09:00
URL: https://tech.guitarrapc.com/entry/2013/04/16/210401
-->

先日のWindows Updateで配布されたKB2823324は困りものですね。

[[MS13-036]Windowsファイル システム カーネル モード ドライバー (ntfs.sys) セキュリティ更新プログラムについて (2013年4月9日)](http://support.microsoft.com/kb/2823324/ja)

特に一部アンチマルウェアソフトで、本KBにかかわる部分のWindowsカーネルをフックしているとBSODとか、涙ものです。

さて、アンインストールがMSから正式に推奨されてるわけですが、自分や社内のPCに問題のKB入っているか調べるのは面倒です。スクリプトを作ったのでよろしければどうぞ。

## スクリプト全文

```ps1
param(
  [string]$kb="KB2823324"
)

Get-WmiObject -Class Win32_QuickFixEngineering | %{
  if($_.HotFixID -eq $kb)
  {
    "$kb found. Opening application list, let's uninstall $kb."
    Invoke-Command {appwiz.cpl}
  }
  else
  {
    "$kb not found. Lucky you!"
  }
} | sort -Unique | select -First 1

pause
```

ということで、PowerShell Remotingでも使えるようにFunctionとしています。
引数の-kbに対象のkbを渡せばサクッと見つけて、もしあれば「プログラム(機能)の追加と削除」を開いてくれます。

利用されたい方はこちらからスクリプトをどうぞ。

[guitarrapc/PowerShellUtil/KBSearch](https://github.com/guitarrapc/PowerShellUtil/tree/master/KBSearch)

おしえていただいたこれ、知りませんでした。

[牟田口大介さん (@mutaguchi)](https://twitter.com/mutaguchi/status/324279119875547137)
