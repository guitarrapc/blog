---
Title: お名前.com から Route53 へのドメイン移管を行ってみよう(Azure DNS はどうなの)
Category:
- AWS
- Azure
Date: 2015-05-05T04:14:04+09:00
URL: https://tech.guitarrapc.com/entry/2015/05/05/041404
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/8454420450093450479
---

2014年に、Route53 でドメインの取得ができるようになりました。

ということで、お名前.com など他で取得していたドメインも Route53 に移管できるようになっています。

以前からやろうやろう詐欺をしていたので、やってみましょう。


[:contents]

# お名前.com の事前作業

## ドメイン移管ロックを未設定にする

お名前.com では、移管作業をロックできます。((デフォルト未設定))

今回は移管するので、未設定になっていることを確認します。(もし未設定になっていない場合は未設定にします)

[f:id:guitarrapc_tech:20150504033254p:plain]

## Whois代行の一時解除

プライバシー保護ともいわれますが、Whois代行を一時的に解除します。これは、移管処理においてAWSはWhoisからのメールアドレス取得を行うためです。

代行はWhois検索されでも自分の住所氏名が表示されないように個人なら必ず設定するでしょう。AWS でも設定できるので移管時だけしかたない。

[f:id:guitarrapc_tech:20150504032650p:plain]

ちなみにWhois代行解除まで少し時間かかります。もし、Whois から AWS がメールアドレスを取得できないと次のエラーがAWS でのドメイン移管時に表示されます。

↓のはサンプルです。

[f:id:guitarrapc_tech:20150504033825p:plain]

## 管理アドレス確認

移管の確認などでメールに連絡が来ます。使ってないアドレスとかじゃないことを確認しておきましょう。

ドメイン詳細から確認できます。

[f:id:guitarrapc_tech:20150504032838p:plain]

## AuthCode の取得

移管に使います。移管元で発行されたものを使うのでドメイン詳細から確認しておきましょう。

[f:id:guitarrapc_tech:20150504032952p:plain]

# AWS 作業

## NameServer 情報取得

移管するので、移管先で Name Server を取得します。

ふつーに、Hosted Zone を作成すれば Name Server が取得できるので確認しましょう。

[f:id:guitarrapc_tech:20150504033405p:plain]

## 移管開始

Route53 > Registered Domain に進むと、Transfer Domain があります。

[f:id:guitarrapc_tech:20150504033518p:plain]

問題なくWhoisから情報取得できたら、Add Cart します。

[f:id:guitarrapc_tech:20150504034017p:plain]

Authorization Code を聞かれるのでお名前.com で取得した AuthCode を入力しましょう。

[f:id:guitarrapc_tech:20150504034106p:plain]

Name Server の欄は、Route53 にHostedZone をすでに登録してあれば勝手に補完されます。

[f:id:guitarrapc_tech:20150504034226p:plain]

Contact情報をいれます。

[f:id:guitarrapc_tech:20150504034258p:plain]

ここで Privacy Protection をすれば、Whois代行と同様にコンタクト情報が隠されます。

[f:id:guitarrapc_tech:20150504034452p:plain]

最後に確認して完了です。

[f:id:guitarrapc_tech:20150504034529p:plain]

これで移管したドメインが表示されます。

[f:id:guitarrapc_tech:20150504034624p:plain]

一覧画面では移管ステータスが見れます。

[f:id:guitarrapc_tech:20150504034655p:plain]

## 移管認証

まずは AWS から Transfer しますか？という確認メールがくるので問題なければクリックして認証します。

差出人メールアドレスは `Amazon Route 53 <noreply@domainnameverification.net>` 。件名は、`Amazon Route 53 <noreply@domainnameverification.net>` だったりします。

[f:id:guitarrapc_tech:20150505035729p:plain]

[f:id:guitarrapc_tech:20150505035200p:plain]

これで、認証確認画面が`Domain Transfer in profress` に変化します。

[f:id:guitarrapc_tech:20150505035234p:plain]

続いて、お名前.com から移管のメール認証が届くので認証します。

[f:id:guitarrapc_tech:20150505035958p:plain]

[f:id:guitarrapc_tech:20150505035322p:plain]

[f:id:guitarrapc_tech:20150505035334p:plain]

続いて、AWS から コンタクト情報が正しいか確認メールがくるので認証します。

[f:id:guitarrapc_tech:20150505040035p:plain]

[f:id:guitarrapc_tech:20150505040107p:plain]

これで、あとはAWS の移管作業が完了するのを待ちます。

##### 移管完了

AWS から移管完了通知がきます。

[f:id:guitarrapc_tech:20150505040204p:plain]

お名前.com からも移管完了通知がきます。

[f:id:guitarrapc_tech:20150505040237p:plain]

[f:id:guitarrapc_tech:20150505040315p:plain]

これで全移管作業が完了します。

この時点で AWS で Private Protection を有効にしていれば、Whois代行のように所有者の住所などは隠されます。

# Azure DNS

記事を書いている最中、MS Ignite で Azure DNS が発表されました。

> - [https://azure.microsoft.com/en-us/services/dns/:title]
>
> - [https://azure.microsoft.com/en-us/documentation/services/dns/:title]

[f:id:guitarrapc_tech:20150505040531p:plain]

Route53 は、ドメインレジストラになれますが、Azure DNS は現状なれなさそうですね。NS Record の委譲までのようです。つまり、本記事のDNS移管は Azure DNS では現状できません。

[f:id:guitarrapc_tech:20150505040745p:plain]

[https://blog.nnasaki.com/entry/2015/05/05/034416:embed:cite]

nslookup で refresh や retry、expiire を見ます。

[f:id:guitarrapc_tech:20150505040851p:plain]

```
PS C:\> nslookup –type=SOA contoso.com

Server: ns1-04.azure-dns.com
Address: 208.76.47.4

contoso.com
primary name server = ns1-04.azure-dns.com
responsible mail addr = msnhst.microsoft.com
serial = 1
refresh = 900 (15 mins)
retry = 300 (5 mins)
expire = 604800 (7 days)
default TTL = 300 (5 mins)
```

TTL などは、AWS Route53 のAレコードデフォルトが 300 です。が、SOA は 900 (15min)なので、かなり短めですね。これは、ちょっとどうかなぁ。感です。

とはいえ、Azure 内部の DNSなどなら Route53をわざわざ使わなくていいのはいいことですね！

# まとめ

ドメイン移管までやりたいなら、AWS Route53 で。

NS の委譲程度でいいなら、Azure DNS でもいいでしょう。

ぜひ使い分けるといいと思います！
