---
Title: ASRok X670E Steel Legend のVRAM点滅とメモリ相性
Category:
- Windows
Date: 2023-05-14T22:46:25+09:00
URL: https://tech.guitarrapc.com/entry/2023/05/14/000000
EditURL: https://blog.hatena.ne.jp/guitarrapc_tech/guitarrapc-tech.hatenablog.com/atom/entry/4207575160648902174
Draft: true
---

以前紹介した現在の Windows マシン ([Windows 11 Professional マシンを構成する](https://tech.guitarrapc.com/entry/2023/05/09/759984) 参照) は、マザーボードにASRok X670E Steel Legend、メモリを128GB 搭載しています。

PCは Sycom で BTOで組んだのですが、到着当日から PC電源投入時に `ASRok X670E Steel Legend` の ポストステータスチェッカーで `VRAM` が点滅で止まる問題があったのでそれについて

[:contents]

# tl;dr;

* ASRok X670E Steel Legend は、メモリ問題がある気配。
* 解決のため、ASRok X670E Steel Legend の BIOSドライバーバージョンをメモリ相性が軽減する `1.21` 以上にしよう。[^1]
* Windows 11 は TPM2.0 を使っているので、インスタントフラットバックで BIOS更新すると以前のPIN が使えなくなる。Windows ログイン画面からMicrosoftアカウントのPIN初期化サイトに遷移できるのでPIN初期化で元通りになるので安心。

# 構成

環境にだけ触れておきます。メモリがBTO提供で特定メーカーじゃないので、相性問題を踏みやすいといえば踏みやすいです。
BTO側で出荷前の動作確認していますが、この問題は起こったり起こらなかったりなので検知は難しいでしょう。そんなものです、しかたない。

* マザーボード: ASRok X670E Steel Legend (ドライバーバージョン `1.18`)
* メモリ: 128GM (32GB×4枚) DDR5-4800 JEDEC準拠品 - Zen4制約で4枚装着時の動作クロックは DDR5-3600

# 症状

BIOS起動時にメモリ4枚装着していると、ポストステータスチェッカー VRAM 点滅から起動しなくなる。
CMOSクリア後のメモリ初期化による初期化待ち (128GB なら5分超え) ではなく、VRAMチェッカーが点滅して2-3分で電源が落ちる。

VRAM点滅はWindows 再起動でも突然再発したりする。対処療法は↑と同じ。

# 対処療法としての解消方法

メモリ4枚での起動にこだわるなら、メモリ1枚/2枚差しに切り替えて起動、シャットダウン後に CMOSクリア (ボタン電池外して10分程度放置) 後に、1枚差しで起動してから4枚差しに切り替え。[^2]

メモリ1枚、2枚でいいなら、メモリを減らして起動すりと問題なく起動することが多い。[^3]

# (おそらく) 根本解決

BIOSのドライバーバージョンを `1.21` にすることで、4枚装着でも問題なく起動するようになったので、これで様子を見ています。
ASRok X670E Steel Legend のドライバー一覧を見ると、1.21 は `Improve memory compatibility` が記載されており、メモリ相性問題がある認識のようです。

![image](https://user-images.githubusercontent.com/3856350/238206405-9302c335-5154-40e5-bd09-3ae9bd990096.png)

ASRok X670E Steel Legend の BIOS バージョンは、 `Instant Flash` か `BIOS Flashback` という方法で更新ができます。

> 参照: [ASRok X670E Steel Legend ユーザーガイド](https://download.asrock.com/Manual/X670E%20Steel%20Legend_Japanese.pdf)

私は、UEFIからの Instant Flash でドライバーが見つけられなかったので BIOS Flashback を使って更新したので手順をみておくといいでしょう。

> 参照: Flashback の公式ガイド https://www.asrock.com/support/QA/FlashbackSOP.jp.pdf

フラッシュバック用のUSBポートに USBメモリを差して、フラッシュバックボタンを押して10分程度は待ったと思います。

# 教訓

BTO のBIOSバージョンは新しい保障がないので、最新バージョンに更新しよう。
あるある教訓ですが、BIOS はそういえば忘れてがち。

# 類似ケース

似たケースがないか探して時に見つけたこの記事は同じ問題に見えますね?

> [【自作PC】DRAM点滅で動作しない【ASRock X670E STEEL LEGEND】 | UEDAX](https://uedax.jp/%E3%80%90%E8%87%AA%E4%BD%9Cpc%E3%80%91dram%E7%82%B9%E6%BB%85%E3%81%A7%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%AA%E3%81%84%E3%80%90asrock-x670e-steel-legend%E3%80%91/)

[^1]: 48/24GB メモリを使うなら `1.24.AS02` が必須。私は `1.24` にして経過観察中。
[^2]: 成功率は低く、全然起動できない場合は4,5回やってもだめですが、繰り返していると起動します。(半日つぶれます)
[^3]: メモリ枚数によって装着スロットが決まっているので注意。1 DIMM なら B2チャンネル、2 DIMM なら A2 と B2。
